<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Regatas Wind</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        /* ====== TOPBAR (franja azul) ====== */
        .topbar{
          position:fixed; top:0; left:0; right:0;
          height:160px;                               /* 2 filas */
          display:flex; align-items:center; justify-content:center;
          z-index:1100;
          background:linear-gradient(180deg, rgba(20,105,150,.95), rgba(20,105,150,.82));
          backdrop-filter:blur(4px);
          pointer-events:auto;
          padding:0 12px;
        }
        .logo{
          position:absolute; left:10px; top:50%; transform:translateY(-50%);
          max-height:64px; width:auto;
          filter:drop-shadow(2px 2px 4px rgba(0,0,0,.3));
        }
        .topbar-center{
          display:flex; flex-direction:column; align-items:center; gap:10px;
          max-width:80%;
        }
        .site-title{
          margin:0; font-size:34px; letter-spacing:2px; color:#fff;
          text-shadow:1px 1px 3px rgba(0,0,0,.5);
          text-align:center; line-height:1;
        }
        .subrow{ display:flex; flex-wrap:wrap; align-items:center; gap:10px; justify-content:center; }

        .topbar-right{
          position:absolute; right:10px; top:50%; transform:translateY(-50%);
          display:flex; align-items:center; gap:12px;
        }

        /* Bot√≥n viento */
        #toggle-viento{
          background:rgba(33,150,243,.95); color:#fff; border:none; border-radius:10px;
          padding:10px 14px; font-size:16px; cursor:pointer;
          transition:transform .15s ease, filter .15s ease, background .15s;
        }
        #toggle-viento.activo{ background:rgba(76,175,80,.95); }
        #toggle-viento:hover{ transform:translateY(-1px); filter:brightness(1.05); }

        /* Chips */
        .chip{
          display:inline-flex; align-items:center; gap:8px;
          padding:8px 12px; border-radius:999px;
          background:rgba(255,255,255,.14); color:#fff; font-weight:600; font-size:15px;
          box-shadow:inset 0 0 0 1px rgba(255,255,255,.15);
          white-space:nowrap;
        }
        .chip .chip-label{ opacity:.85; font-weight:500; }

        #panel-viento, #panel-metricas{
          display:flex; align-items:center; gap:10px;
          background:transparent; border:none; box-shadow:none; padding:0; margin:0;
          color:#fff;
        }

        .bearing-needle{ display:inline-block; transform-origin:center; transition:transform .5s ease; }

        /* Mapa debajo del header */
        body{ margin:0; padding:170px 0 0 0; }
        #map{ height:90vh; position:relative; }

        /* Canvas part√≠culas ‚Äî m√°s bajo que polil√≠neas */
        #wind-canvas{ position:absolute; top:0; left:0; pointer-events:none; z-index:300; }

        #controles-superiores{ display:none; }

        /* ====== MODO COMPACTO (celular) ====== */
        @media (max-width: 640px) {
          .topbar { height: 110px; }
          #site-title { display:none; }

          .logo {
            width: 52px; height: 52px; max-height:none;
            object-fit:cover; object-position:left center;
            left: 10px; top: 50%; transform: translateY(-50%);
          }

          #toggle-viento {
            position: absolute; right: 8px; top: 10px;
            width: 52px; height: 52px; padding:0; border-radius:12px; font-size:0;
          }
          #toggle-viento::before {
            content: "üå¨Ô∏è"; display:block; font-size:22px; line-height:52px; text-align:center;
          }

          /* dos filas de chips, centradas, sin scroll lateral */
          .subrow{
            display:grid;
            grid-template-columns: 1fr;
            row-gap:6px;
            justify-items:center;
          }
          #panel-viento{ order:1; }
          #panel-metricas{ order:2; }

          .chip{ font-size:13px; padding:6px 10px; }
          body{ padding-top: 120px; } /* 110 header + respirito */
        }
    </style>
</head>
<body id="page-top" style="background-image:url('img/fondo_regata.png'); background-size:cover; background-position:center; background-repeat:no-repeat;">

<!-- HEADER FIJO -->
<div class="topbar">
    <img src="img/negro_transparente_geotraser.png" alt="GEOTRASER" class="logo">

    <div class="topbar-center">
        <h1 id="site-title" class="site-title"></h1>

        <!-- fila de chips -->
        <div class="subrow">
            <div id="panel-viento">
                <div class="chip"><span class="chip-label">Dir</span><span id="vientoDir">‚Äì</span></div>
                <div class="chip"><span class="chip-label">Vel</span><span id="vientoVel">‚Äì</span></div>
                <div class="chip"><span class="chip-label">R√°f</span><span id="vientoRafagas">‚Äì</span></div>
            </div>

            <div id="panel-metricas">
                <div class="chip">
                    <span class="chip-label">Bearing</span>
                    <span id="bearing-value">---¬∞</span>
                    <span id="bearing-needle" class="bearing-needle">‚Üë</span>
                </div>
                <div class="chip"><span class="chip-label">Dist</span><span id="distancia-value">0.00</span></div>
                <div class="chip"><span class="chip-label">Veloc</span><span id="velocidad-value">0.0</span></div>
            </div>
        </div>
    </div>

    <div class="topbar-right">
        <button id="toggle-viento">üå¨Ô∏è Viento ON</button>
    </div>
</div>

<!-- input oculto que tu JS lee -->
<div id="controles-superiores" style="display:none;">
    <label>Ancho del Control (m): <span id="anchoLabel">10</span></label>
    <input type="range" id="anchoCorredor" min="0" max="100" value="10" />
</div>

<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="maparepew.js"></script>

<footer style="background-color:white; padding:1rem; border-radius:10px; box-shadow:0 0 6px rgba(0,0,0,0.3);">
    <img src="img/negro_transparente_geotraser.png" alt="GEOTRASER" style="max-width:300px; display:block; margin:0 auto;">
</footer>
</body>
</html>
